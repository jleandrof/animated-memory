<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
</head>
<body>
    <div class="raw" style="width:600px;height:250px;">
        <div id="Total" class="float-left" style="width:600px;height:250px;"></div>
        <hr>
        <div id="Equivalente" class="float-left" style="width:600px;height:250px;"></div>
        <a class="btn btn-primary float-right text-white" id="exportReportButton" ><small>Exportar para csv</small></a>
    </div>   
    <script>


        var plot = function(url_csv, id_div, title) {

            Plotly.d3.csv(url_csv, function(data) {
            var x = [], y = [];

            for (var i=0; i<data.length; i++) {
                row = data[i];
                x.push( row['Ano'] );
                y.push( row[id_div] );
            }

            var traces = [{
                x: x,
                y: y,
                type: 'bar',
                marker: {color: 'rgb(26, 118, 255)'}
            }];

            var layout = {
                title: title,
                showlegend: false,
                yaxis: {
                    fixedrange: true,
                    tickformat : '.d',
                    tickmode : 'array'
                },
                xaxis : {
                    fixedrange: true
                }
            };

            Plotly.newPlot(id_div, traces, layout, {displayModeBar: false})
        });

        }


        plot('https://raw.githubusercontent.com/jleandrof/animated-memory/master/passageiros.csv', 'Total', 'Total de passageiros por ano');
        plot('https://raw.githubusercontent.com/jleandrof/animated-memory/master/passageiros.csv', 'Equivalente', 'Passageiros equivalentes por ano');



        
        
        $(document).ready(function () {

//When the export report button is clicked, download what is shown in the report as 
//a CSV file.  The lastValue tracking helps ensures that no row is recorded more than once.
$('#exportReportButton').on('click', function() { 
    var theReport = 'Ano,Total\n2008,98975878\n2009,96231912\n2010,99941489\n2011,95625648\n2012,91217151\n2013,90723508\n2014,94659784\n2015,94926783\n2016,89057825\n2017,81795437\n2018,79110437' 
  var element = document.createElement('a');
  element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(theReport));
  element.setAttribute('download', 'total de passageiros.csv');
  element.style.display = 'none';
  if (typeof element.download != "undefined") {
    document.body.appendChild(element);
    element.click();
    document.body.removeChild(element);
  }
  else {
    alert('This functionality is not supported by the current browser, recommend trying with Google Chrome instead.  (http://caniuse.com/#feat=download)');
  }
});

});

        
    </script>




</body>
</html>
